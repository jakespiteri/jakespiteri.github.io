<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="Jake Spiteri">
<meta name="description" content="R makes it relatively easy to structure a project, by creating a “project”. It also integrates git and github which makes it easy to track changes and publish code to the web.
Projects: organizing code The best way to approach projects is to maintain a well-defined file structure. RStudio projects allow you to easily divide your work into different directories. Of course, this can be done manually. Generally a good high-level file structure within your project’s directory is:" />
<meta name="keywords" content="statistics, mathematics, data science, machine learning, deep learning" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="#252627" />
<link rel="canonical" href="https://jakespiteri.co.uk/portfolio/computing/report-3/" />


    <title>
        
            Portfolio Report 3: Projects, version control, and packages :: Jake Spiteri  — Jake Spiteri
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="https://jakespiteri.co.uk/main.min.7bfbbe12786fa0ded4b4c0d792cbb36a5bd0bdb0b856dde57aa7b1f6fe0f2b87.css">


    
        <link rel="stylesheet" type="text/css" href="static/style.css">
    



    <link rel="apple-touch-icon" sizes="180x180" href="https://jakespiteri.co.uk/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://jakespiteri.co.uk/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://jakespiteri.co.uk/favicon-16x16.png">
    <link rel="manifest" href="https://jakespiteri.co.uk/site.webmanifest">
    <link rel="mask-icon" href="https://jakespiteri.co.uk/safari-pinned-tab.svg" color="#252627">
    <link rel="shortcut icon" href="https://jakespiteri.co.uk/favicon.ico">
    <meta name="msapplication-TileColor" content="#252627">
    <meta name="theme-color" content="#252627">

<meta itemprop="name" content="Portfolio Report 3: Projects, version control, and packages">
<meta itemprop="description" content="R makes it relatively easy to structure a project, by creating a “project”. It also integrates git and github which makes it easy to track changes and publish code to the web.
Projects: organizing code The best way to approach projects is to maintain a well-defined file structure. RStudio projects allow you to easily divide your work into different directories. Of course, this can be done manually. Generally a good high-level file structure within your project’s directory is:">

<meta itemprop="wordCount" content="1572">
<meta itemprop="image" content="https://jakespiteri.co.uk"/>



<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://jakespiteri.co.uk"/>

<meta name="twitter:title" content="Portfolio Report 3: Projects, version control, and packages"/>
<meta name="twitter:description" content="R makes it relatively easy to structure a project, by creating a “project”. It also integrates git and github which makes it easy to track changes and publish code to the web.
Projects: organizing code The best way to approach projects is to maintain a well-defined file structure. RStudio projects allow you to easily divide your work into different directories. Of course, this can be done manually. Generally a good high-level file structure within your project’s directory is:"/>












<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-159259654-1', 'auto');
	
	ga('send', 'pageview');
}
</script>





<link href='//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css' rel='stylesheet' type='text/css' />



    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://jakespiteri.co.uk/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">$ cd /home/</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://jakespiteri.co.uk/about/">About</a></li><li><a href="https://jakespiteri.co.uk/portfolio/">Portfolio</a></li><li><a href="https://jakespiteri.co.uk/posts/">Posts</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="https://jakespiteri.co.uk/portfolio/computing/report-3/">Portfolio Report 3: Projects, version control, and packages</a></h2>

            

            <div class="post-content">
                


<p>R makes it relatively easy to structure a project, by creating a “project”. It also integrates git and github which makes it easy to track changes and publish code to the web.</p>
<div id="projects-organizing-code" class="section level1">
<h1>Projects: organizing code</h1>
<p>The best way to approach projects is to maintain a well-defined file structure. RStudio projects allow you to easily divide your work into different directories. Of course, this can be done manually. Generally a good high-level file structure within your project’s directory is:</p>
<ul>
<li><code>R/</code> — Contains all of the project’s R scripts. It is best to not divide these files into subdirectories.</li>
<li><code>README.md</code> — A markdown document describing the project.</li>
<li><code>data/</code> — Contains the data used for the project. It may be split into subdirectories <code>raw/</code> and <code>processed/</code>.</li>
<li><code>doc/</code> — Contains the documentation for the project. If implementing a method, an academic paper detailing the method may be found here.</li>
<li><code>output/</code> — The output(s) produced by applying the R scripts in <code>R/</code> to the data. The outputs may be divided into subdirectories; all plots may be in a <code>figures/</code> folder for example.</li>
<li><code>tests/</code> — Contains R scripts which test the functions developed in the package. It is best practice to produce test functions which check that functions work as expected. These functions can also be run every time code is changed, so the author is aware when functionality breaks.</li>
</ul>
</div>
<div id="version-control-with-git-and-github" class="section level1">
<h1>Version control with git and GitHub</h1>
<p>A version control system that keeps track of the changes made to a set of documents. Each time we track a change, it creates a snapshot of our files which we can revert back to at any point in time. Many of us make copies of our files and store multiple versions of them. Version control systems such as git make this process extremely easy and less prone to errors.</p>
</div>
<div id="git" class="section level1">
<h1>Git</h1>
<div id="setup" class="section level2">
<h2>Setup</h2>
<p>Once git is installed, it will be useful to set your identity as a global configuration parameter. These parameters can be set for specified git repositories, or globally.</p>
<p>To set your name and email address, use the following commands in the terminal.</p>
<pre><code>git config --global user.name &quot;Your Name&quot;
git config --global user.email name@domain.co.uk</code></pre>
<p>We can always check the global configuration using the following commands:</p>
<pre><code>git config --list --show-origin</code></pre>
<p>Otherwise, we can directly view the global parameters using the following</p>
<pre><code>git config --global &lt;parameter&gt;</code></pre>
</div>
<div id="initializing-a-git-repository" class="section level2">
<h2>Initializing a git repository</h2>
<p>We can easily use git to start tracking changes within a directory. Simply navigate to the top-level folder for which you want to track changes in, and type</p>
<pre><code>git init</code></pre>
<p>The subdirectory will then become a fully-functional git repository. Before git starts to track files you must add them to the staging area.</p>
</div>
<div id="adding-files-to-the-staging-area" class="section level2">
<h2>Adding files to the staging area</h2>
<p>A useful command before adding files to the staging area is <code>git status</code>. This will show the status of every file within your working directory: what files have been edited, moved, deleted, and which files are being tracked or not. It will also give some advice on how to add files to the staging area, how to discard changes in the current working tree, and how to unstage files.</p>
<p>To add a file to the staging area, use the command</p>
<pre><code>git add &lt;filename&gt;</code></pre>
<p>Note that you can add entire subdirectories to the staging area using this command. You may encounter a situation in which you have staged a file you do not want to track. In this case you can remove said file from the staging area using</p>
<pre><code>git reset HEAD &lt;filename&gt;</code></pre>
<p>Similarly to adding files to the staging area, you can unstage individual files or entire subdirectories. To remove everything from the staging area, simply use</p>
<pre><code>git reset HEAD .</code></pre>
</div>
<div id="committing-changes" class="section level2">
<h2>Committing changes</h2>
<p>Once a file has been staged, we can commit the file using</p>
<pre><code>git commit -m &quot;commit message&quot;</code></pre>
<p>It is good practice to commit only files which change a single piece of functionality, rather than commit <em>all</em> changes that have been made. It is also useful to add an informative commit message which explains what has changed. The commit saves the changes that have been made to the code, so we can return to a previous version of the code if necessary.</p>
</div>
<div id="reverting-resetting" class="section level2">
<h2>Reverting / Resetting</h2>
<p>Sometimes changes have been made locally which have not been commited, which break functionality. In such a case, we may want to revert to the last commit. To do this we can use</p>
<pre><code>git revert HEAD</code></pre>
<p>We can think of this as undoing changes that have been made. It inverts the last commit and then appends a new commit with this inverted content. It is also important to note the difference between <code>revert</code> and <code>reset</code>. Firstly, <code>git revert</code> changes made in a single commit (this can be <em>any</em> commit in the repo’s history) whereas <code>git reset</code> returns the repo to a previous commit by <em>removing</em> all subsequent commits. So <code>revert</code> maintains the history of the repo by adding a new commit, and <code>reset</code> <em>deletes</em> some history by returning to a previous commit and deleting subsequent commits.</p>
</div>
<div id="creating-a-branch" class="section level2">
<h2>Creating a branch</h2>
<p>When making substantial changes to an existing repo, it may be better to work on a different ‘branch’ of the project. We can then work on the branch without affecting the master branch.</p>
<p>To create a new git branch, we use the following</p>
<pre><code>git branch &lt;branch-name&gt;</code></pre>
<p>To then switch to our new branch we use</p>
<pre><code>git checkout &lt;branch-name&gt;</code></pre>
<p>This means we can easily switch between the master and existing branches. In order to merge the changes made in the new branch to the master, we switch to the master using <code>git checkout master</code> and then merge using <code>git merge &lt;branch-name&gt;</code>.</p>
<p>If there are conflicts, git will add comments to the files which will need to be manually addressed before merging.</p>
<p>To delete a branch simply use <code>git branch -d &lt;branch-name&gt;</code>.</p>
</div>
<div id="check-out-an-old-version" class="section level2">
<h2>Check out an old version</h2>
<p>You may want to return to an old version of your code. To do this we can get commit hashes using the log <code>git log</code>, and then checkout an old snapshot of the code using</p>
<pre><code>git checkout &lt;commit hash&gt; -b &lt;branch-name&gt;</code></pre>
</div>
</div>
<div id="packages" class="section level1">
<h1>Packages</h1>
<p>Similar to projects, RStudio also makes it easy to create packages. Within a package there are some necessary files such as</p>
<ul>
<li><code>DESCRIPTION</code> — Provides details of who created the package, who maintains it, the version of R used etc.</li>
<li><code>LICENSE</code> — Details the license you have chosen for the package e.g. GPL-2, MIT+, etc.</li>
<li><code>NAMESPACE</code></li>
<li><code>R/</code> — A folder containing the package’s R scripts.</li>
<li><code>man</code> — A folder containing the documentation.</li>
<li><code>tests</code> — A folder containing scripts that test the package’s functionality.</li>
</ul>
<div id="description-file" class="section level2">
<h2>Description file</h2>
<p>The first thing you should do after creating a package is edit the DESCRIPTION file. The template provided by RStudio makes this pretty self explanatory. You should add the license, the title, and the author, etc.</p>
</div>
<div id="documentation" class="section level2">
<h2>Documentation</h2>
<p>A good package should be well documented. The package <code>devtools</code> and RStudio make documenting code straightforward. You can enable automatic documentation building in RStudio after installing the <code>devtools</code> package, by clicking <code>Build -&gt; Configure Build Toolds... -&gt; Generate documentation with Roxygen</code>.</p>
<p>You can also directly add documentation for functions in a package by right clicking the function and selecting <code>Code -&gt; Insert Roxygen skeleton</code>. You can describe the function’s features and parameters in the skeleton above the function, and this will be added to the help document for the function.</p>
</div>
<div id="testing" class="section level2">
<h2>Testing</h2>
<p>When developing a package it is useful to use a test suite to ensure that functionality doesn’t break during development. In order to test the functionality you must write test scripts that compare the output of a function to the expected output. Writing test scripts requires additional effort but they greatly simplify the development process. Testing ensures that the code has fewer bugs as we explicitly test the code’s behavior.
Testing in RStudio can be done with the <code>testthat</code> package. Once this package is installed you should run</p>
<pre><code>usethis::testthat(&quot;&lt;name&gt;&quot;)</code></pre>
<p>This will create a new directory called <code>tests</code> in which you can add your test scripts. There should already be a test script in the folder called <code>test-&lt;name&gt;.R</code>.</p>
<p>Once the test suite is set up the workflow is simple: We modify our code or tests, test the package by running <code>devtools::test()</code>, and fix any errors that have occurred.</p>
<p>Chapter 10 of the book R Packages is a great resource for writing test scripts. The book can be found <a href="https://r-pkgs.org/">here</a>.</p>
</div>
<div id="coverage" class="section level2">
<h2>Coverage</h2>
<p>When creating a package we want to develop a well-rounded test suite. It may be difficult to ensure that all of our code is covered by our tests — it seems plausible that there are some scenarios which should throw errors which have not been tested by a script.
To mitigate this issue we can use tools that tell us which lines have been tested by our test suite. This is called <em>code coverage</em>. This is very easy to do in R using the package <code>covr</code>. Once installed we can test the coverage of a package by running</p>
<pre><code>covr:report()</code></pre>
<p>The report provides a lot of useful information: which lines have been covered, which have not been covered, how many times a line is covered, etc. It will also tell us which percentage of the code is covered, and ideally we will strive for 100% coverage. This means that when new code is added to the package we will need to write new test scripts.</p>
</div>
</div>
<div id="example" class="section level1">
<h1>Example</h1>
<p>An example R package using all of the tools described above can be found <a href="https://github.com/jakespiteri/vectools-travis/">here</a>.</p>
</div>

            </div>
        </article>

        <hr />

        <div class="post-info">
  			</div>

        
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2020</span>
            
                <span><a href="https://jakespiteri.co.uk">Jake Spiteri</a></span>
            
            <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span>
            <span> <a href="https://jakespiteri.co.uk/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
    </div>
</footer>
    



<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js"></script>



<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>


    <script src="https://jakespiteri.co.uk/js/math-code.js"></script>
<script async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  </body>
</html>
            
        </div>

        




<script type="text/javascript" src="https://jakespiteri.co.uk/bundle.min.2d5469329143160ae2456a69c3c76dc2d0a3b212b46afe291a51bd68650ed6f8697e001dab54f1c272c77ce08092a8c55e5bb4314e0ee334aab4b927ec896638.js" integrity="sha512-LVRpMpFDFgriRWppw8dtwtCjshK0av4pGlG9aGUO1vhpfgAdq1TxwnLHfOCAkqjFXlu0MU4O4zSqtLkn7IlmOA=="></script>
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-159259654-1', 'auto');
        ga('send', 'pageview');
    </script>



    </body>
</html>
